// ============================================
// ğŸ”§ ×ª×™×§×•×Ÿ × ×§×•×“×ª×™ #1 - onresult (×œ×”×¦×™×’ ××œ×œ ×‘×–××Ÿ ×××ª)
// ============================================
// ×—×¤×© ××ª ×”×©×•×¨×•×ª 130-141 ×‘×§×•×‘×¥:
// 
// ×”×§×•×“ ×”×™×©×Ÿ:
/*
this.recognition.onresult = (event) => {
    const last = event.results.length - 1;
    const transcript = event.results[last][0].transcript;
    
    document.getElementById('transcript').textContent = transcript;
    
    if (event.results[last].isFinal) {
        this.processCommand(transcript);
    }
};
*/

// âœ… ×”×—×œ×£ ×œ:

this.recognition.onresult = (event) => {
    let interimTranscript = '';
    let finalTranscript = '';
    
    for (let i = event.resultIndex; i < event.results.length; i++) {
        const transcript = event.results[i][0].transcript;
        if (event.results[i].isFinal) {
            finalTranscript += transcript + ' ';
        } else {
            interimTranscript += transcript;
        }
    }
    
    // âœ… ×”×¦×’ interim ×‘×–××Ÿ ×××ª
    let display = finalTranscript.trim();
    if (interimTranscript.trim()) {
        display = display ? display + '\nğŸ’¬ ' + interimTranscript : interimTranscript;
    }
    document.getElementById('transcript').textContent = display;
    
    if (finalTranscript.trim()) {
        this.processCommand(finalTranscript.trim());
    }
};


// ============================================
// ğŸ”§ ×ª×™×§×•×Ÿ × ×§×•×“×ª×™ #2 - onend (×œ× ×¢×•×¦×¨, ××ª×—×™×œ ××—×“×©)
// ============================================
// ×—×¤×© ××ª ×”×©×•×¨×•×ª 144-151 ×‘×§×•×‘×¥:
//
// ×”×§×•×“ ×”×™×©×Ÿ:
/*
this.recognition.onend = () => {
    this.isListening = false;
    document.getElementById('centralCore').classList.remove('listening');
    
    if (!this.isSpeaking) {
        setTimeout(() => this.startListening(), 1000);
    }
};
*/

// âœ… ×”×—×œ×£ ×œ:

this.recognition.onend = () => {
    this.isListening = false;
    document.getElementById('centralCore').classList.remove('listening');
    
    // âœ… ×”×ª×—×œ ××—×“×© ××•×˜×•××˜×™×ª (×œ× ×¢×•×¦×¨)
    if (!this.isSpeaking) {
        setTimeout(() => {
            try {
                this.recognition.start();
            } catch(e) {
                // Recognition ×›×‘×¨ ×¨×¥
            }
        }, 500);
    }
};


// ============================================
// ğŸ”§ ×ª×™×§×•×Ÿ × ×§×•×“×ª×™ #3 - updateStatus (×”×•×¡×£ ×–××Ÿ + ×§×•×“ ×‘×™× ××¨×™)
// ============================================
// ×—×¤×© ××ª ×”×©×•×¨×•×ª 272-274 ×‘×§×•×‘×¥:
//
// ×”×§×•×“ ×”×™×©×Ÿ:
/*
updateStatus(text) {
    document.getElementById('status').textContent = text;
}
*/

// âœ… ×”×—×œ×£ ×œ:

updateStatus(text) {
    const now = new Date();
    const timeDecimal = (now.getMilliseconds() / 1000).toFixed(4);
    const binaryCode = '0101-0101(0101)';
    const timeFormat = `(-+${timeDecimal}+-)`;
    
    const status = document.getElementById('status');
    status.textContent = `${text} | ${timeFormat} | ${binaryCode}`;
    status.style.color = text.includes('ğŸ¤') ? '#ffd700' : '#00ff00';
}
